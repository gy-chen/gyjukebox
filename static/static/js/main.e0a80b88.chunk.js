(this["webpackJsonpgyjukebox-web"]=this["webpackJsonpgyjukebox-web"]||[]).push([[0],{1:function(t,e,a){t.exports={headerRowContainer:"SearchList_headerRowContainer__27NaD",rowContainer:"SearchList_rowContainer__1Ed_j",rowHeader:"SearchList_rowHeader__2B7vq",albumRowContainer:"SearchList_albumRowContainer__lkJqm",artistRowContainer:"SearchList_artistRowContainer__16kJT",trackRowContainer:"SearchList_trackRowContainer__yQ_-R",playlistRowContainer:"SearchList_playlistRowContainer__3KWy0",removeDefaultListItemStyle:"SearchList_removeDefaultListItemStyle__1G_fk",removeDefaultListStyle:"SearchList_removeDefaultListStyle__2aqII"}},10:function(t,e,a){t.exports={container:"CurrentTrack_container__2tP24",titleContainer:"CurrentTrack_titleContainer__1OyeW",trackName:"CurrentTrack_trackName__2-W8x",userContainer:"CurrentTrack_userContainer__3l_it"}},12:function(t,e,a){t.exports={container:"App_container__3iLfG",searchBarContainer:"App_searchBarContainer__2vd7W",searchListContainer:"App_searchListContainer__2tHy_",footerBarContainer:"App_footerBarContainer__neaEC"}},15:function(t,e,a){t.exports={container:"SearchBar_container__mRTEy",searchInput:"SearchBar_searchInput__15KuH",searchButton:"SearchBar_searchButton__1x_vH"}},16:function(t,e,a){t.exports={container:"TrackListItem_container__1REr3",queueButton:"TrackListItem_queueButton__2XZ7W",queuedButton:"TrackListItem_queuedButton__2L4Uh"}},17:function(t,e,a){t.exports={container:"Login_container__27oOZ",loginButton:"Login_loginButton__3JQWQ"}},32:function(t,e,a){t.exports={container:"PlayButton_container__2wtmu"}},33:function(t,e,a){t.exports={container:"FooterBar_container__1yaA6"}},34:function(t,e,a){t.exports={item:"AlbumColumnItem_item__HfS3o ColumnItem_item__hfWEn"}},35:function(t,e,a){t.exports={item:"ArtistColumnItem_item__3PZ5Y ColumnItem_item__hfWEn"}},36:function(t,e,a){t.exports={seperator:"ArtistsColumnItem_seperator__2zIqz"}},37:function(t,e,a){t.exports={container:"AlbumListItem_container__22gww",searchIcon:"AlbumListItem_searchIcon__1Zunl"}},38:function(t,e,a){t.exports={container:"ArtistListItem_container__2T-wv"}},39:function(t,e,a){t.exports={item:"PlaylistColumnItem_item__3pIYf ColumnItem_item__hfWEn"}},40:function(t,e,a){t.exports={container:"PlaylistListItem_container__1E4I8"}},46:function(t,e,a){t.exports=a(72)},51:function(t,e,a){},72:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),i=a(27),c=a.n(i),o=(a(51),a(13)),l=a(3),s=a.n(l),u=a(44),m=a(5),_=a(6),k=a(8),h=a(7),p=a(2),d=a(9),f=a(17),C=a.n(f),v=function(t){function e(t){var a;return Object(m.a)(this,e),(a=Object(k.a)(this,Object(h.a)(e).call(this,t)))._onLoginButtonClick=a._onLoginButtonClick.bind(Object(p.a)(a)),a}return Object(d.a)(e,t),Object(_.a)(e,[{key:"componentDidMount",value:function(){var t=this.props.onLoginCallback,e=new URLSearchParams(window.location.search).get("token")||null;e&&t&&t(e)}},{key:"_onLoginButtonClick",value:function(){window.open("https://jukebox.gyhost.icu/login?callback_url=https://jukebox.gyhost.icu","_self")}},{key:"render",value:function(){return r.a.createElement("div",{className:C.a.container},r.a.createElement("h1",null,"GYJUKEBOX"),r.a.createElement("button",{onClick:this._onLoginButtonClick,className:C.a.loginButton},"Login"))}}]),e}(r.a.Component),y=a(45),b=a(28),w=a(15),E=a.n(w),B=function(t){var e=t.onSearchButtonClick,a=r.a.useState(""),n=Object(y.a)(a,2),i=n[0],c=n[1],o=function(t){t.preventDefault(),e&&e(i)};return r.a.createElement("form",{className:E.a.container,onSubmit:o},r.a.createElement("input",{type:"text",className:E.a.searchInput,value:i,onChange:function(t){return c(t.target.value)}}),r.a.createElement("button",{className:E.a.searchButton,onClick:o},r.a.createElement(b.a,null)))},A=a(29),S=a(1),T=a.n(S),L=function(t){function e(t){var a;return Object(m.a)(this,e),(a=Object(k.a)(this,Object(h.a)(e).call(this,t)))._renderAlbums=a._renderAlbums.bind(Object(p.a)(a)),a._renderArtists=a._renderArtists.bind(Object(p.a)(a)),a._renderPlaylists=a._renderPlaylists.bind(Object(p.a)(a)),a._renderTracks=a._renderTracks.bind(Object(p.a)(a)),a._isTrackInQueue=a._isTrackInQueue.bind(Object(p.a)(a)),a}return Object(d.a)(e,t),Object(_.a)(e,[{key:"_renderAlbums",value:function(){var t=this.props,e=t.albums,a=t.albumComponent,n=t.onViewAlbumButtonClick,i=t.onViewArtistButtonClick;return a&&e&&0!==e.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"".concat(T.a.albumRowContainer," ").concat(T.a.headerRowContainer)},r.a.createElement("div",{className:T.a.rowHeader},"Album"),r.a.createElement("div",{className:T.a.rowHeader},"Artist")),e.map((function(t){return r.a.createElement("li",{className:"".concat(T.a.removeDefaultListItemStyle," ").concat(T.a.rowContainer)},r.a.createElement(a,{album:t,onViewAlbumButtonClick:n,onViewArtistButtonClick:i}))}))):null}},{key:"_renderArtists",value:function(){var t=this.props,e=t.artists,a=t.artistComponent,n=t.onViewArtistButtonClick;return a&&e&&0!==e.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{key:"artistsHeaderRow",className:"".concat(T.a.headerRowContainer," ").concat(T.a.artistRowContainer)},r.a.createElement("div",{className:T.a.rowHeader},"Artist")),e.map((function(t){return r.a.createElement("li",{key:t.uri,className:"".concat(T.a.removeDefaultListItemStyle," ").concat(T.a.rowContainer)},r.a.createElement(a,{artist:t,onViewArtistButtonClick:n}))}))):null}},{key:"_renderPlaylists",value:function(){var t=this.props,e=t.playlists,a=t.playlistComponent,n=t.onViewPlaylistButtonClick;return a&&e&&0!==e.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{key:"playlistsHeaderRow",className:"".concat(T.a.headerRowContainer," ").concat(T.a.playlistRowContainer)},r.a.createElement("div",{className:T.a.rowHeader},"Playlist"),r.a.createElement("div",{className:T.a.rowHeader},"Owner")),e.map((function(t){return r.a.createElement("li",{key:t.uri,className:"".concat(T.a.removeDefaultListItemStyle," ").concat(T.a.rowContainer)},r.a.createElement(a,{playlist:t,onViewPlaylistButtonClick:n}))}))):null}},{key:"_isTrackInQueue",value:function(t){return this.props.inQueueTracks.map((function(t){return t.uri})).includes(t.uri)}},{key:"_renderTracks",value:function(){var t=this,e=this.props,a=e.tracks,n=e.trackComponent,i=e.onQueueTrackButtonClick,c=e.onViewAlbumButtonClick,o=e.onViewArtistButtonClick;return n&&a&&0!==a.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{key:"tracksHeaderRow",className:"".concat(T.a.trackRowContainer," ").concat(T.a.headerRowContainer)},r.a.createElement("div",{className:T.a.rowHeader},"Track"),r.a.createElement("div",{className:T.a.rowHeader},"Artist"),r.a.createElement("div",{className:T.a.rowHeader},"Album"),r.a.createElement("div",{className:T.a.rowHeader},r.a.createElement(A.a,null))),a.map((function(e){return r.a.createElement("li",{key:e.uri,className:"".concat(T.a.removeDefaultListItemStyle," ").concat(T.a.rowContainer)},r.a.createElement(n,{track:e,inQueue:t._isTrackInQueue(e),onQueueTrackButtonClick:i,onViewAlbumButtonClick:c,onViewArtistButtonClick:o}))}))):null}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:T.a.removeDefaultListStyle},this._renderAlbums()),r.a.createElement("ul",{className:T.a.removeDefaultListStyle},this._renderArtists()),r.a.createElement("ul",{className:T.a.removeDefaultListStyle},this._renderPlaylists()),r.a.createElement("ul",{className:T.a.removeDefaultListStyle},this._renderTracks()))}}]),e}(r.a.Component);L.defaultProps={inQueueTracks:[]};var g=L,j=a(30),P=a(31),O=a(10),R=a.n(O),N=function(t){var e=t.track,a=t.user;return e?r.a.createElement("div",{className:R.a.container},r.a.createElement("div",{className:R.a.titleContainer},r.a.createElement("span",{className:R.a.trackName},e.name),r.a.createElement(j.a,null),r.a.createElement("span",null,e.artists.map((function(t){return t.name})).join(", "))),r.a.createElement("div",{className:R.a.userContainer},r.a.createElement(P.a,null),r.a.createElement("span",null,a.name))):null},I=a(32),x=a.n(I),V=function(t){var e=t.onPlayButtonClick;return r.a.createElement("div",{className:x.a.container,onClick:e},"Play")},D=a(33),H=a.n(D),Q=function(t){var e=t.displayPlayButton,a=t.currentTrack;a=a||{};var n=function(){var e=t.onPlayButtonClick;e&&e()};return r.a.createElement("div",{className:H.a.container},r.a.createElement(N,{user:a.user,track:a.track}),e&&a.track?r.a.createElement(V,{onPlayButtonClick:n}):null)},M=a(34),q=a.n(M),W=function(t){var e=t.album;return r.a.createElement("div",null,r.a.createElement("span",{className:q.a.item,onClick:function(){var a=t.onViewAlbumButtonClick;a&&a(e)}},e.name))},Y=a(35),F=a.n(Y),J=function(t){var e=t.artist;return r.a.createElement("span",{className:F.a.item,onClick:function(){var a=t.onViewArtistButtonClick;a&&a(e)}},e.name)},U=a(36),Z=a.n(U),z=function(t){var e=t.artists;return function(){var a=t.onViewArtistButtonClick;return e.reduce((function(t,n,i){return t.push(r.a.createElement(J,{artist:n,onViewArtistButtonClick:a})),i!==e.length-1&&t.push(r.a.createElement("span",{className:Z.a.seperator},", ")),t}),[])}()},G=a(37),K=a.n(G),X=function(t){var e=t.album,a=t.onViewAlbumButtonClick,n=t.onViewArtistButtonClick;return r.a.createElement("div",{className:K.a.container},r.a.createElement("div",null,r.a.createElement(W,{album:e,onViewAlbumButtonClick:a})),r.a.createElement("div",null,r.a.createElement(z,{artists:e.artists,onViewArtistButtonClick:n})))},$=a(38),tt=a.n($),et=function(t){var e=t.artist,a=t.onViewArtistButtonClick;return r.a.createElement("div",{className:tt.a.container},r.a.createElement("div",null,r.a.createElement(J,{artist:e,onViewArtistButtonClick:a})))},at=a(39),nt=a.n(at),rt=function(t){var e=t.playlist;return r.a.createElement("span",{className:nt.a.item,onClick:function(){var a=t.onViewPlaylistButtonClick;a&&a(e)}},e.name)},it=a(40),ct=a.n(it),ot=function(t){var e=t.playlist,a=t.onViewPlaylistButtonClick;return r.a.createElement("div",{className:ct.a.container},r.a.createElement("div",null,r.a.createElement(rt,{playlist:e,onViewPlaylistButtonClick:a})),r.a.createElement("div",null,e.owner.display_name))},lt=a(41),st=a(42),ut=a(16),mt=a.n(ut),_t=function(t){var e=t.track,a=t.onViewArtistButtonClick,n=function(){var a=t.onQueueTrackButtonClick;a&&a(e)};return r.a.createElement("div",{className:mt.a.container},r.a.createElement("div",null,e.name),r.a.createElement("div",null,r.a.createElement(z,{artists:e.artists,onViewArtistButtonClick:a})),r.a.createElement("div",null,r.a.createElement(W,{album:e.album,onViewAlbumButtonClick:function(){var a=t.onViewAlbumButtonClick;a&&a(e.album)}})),r.a.createElement("div",null,t.inQueue?r.a.createElement(st.a,{className:mt.a.queuedButton}):r.a.createElement(lt.a,{onClick:n,className:mt.a.queueButton})))},kt=a(14),ht=a.n(kt),pt=a(43),dt=a.n(pt).a.create({baseURL:"https://jukebox.gyhost.icu"}),ft=function(t){var e,a,n=arguments;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=n.length>1&&void 0!==n[1]?n[1]:0,r.next=3,s.a.awrap(dt.get("/search",{params:{q:t,offset:e}}));case 3:return a=r.sent,r.abrupt("return",a.data);case 5:case"end":return r.stop()}}))},Ct=function(t){return dt.post("/track/".concat(t.id,"/enqueue"))},vt=function(){var t,e;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.awrap(dt.get("/track/current"));case 2:if(t=a.sent,e=t.data){a.next=6;break}return a.abrupt("return",{track:null,user:null});case 6:return a.abrupt("return",e);case 7:case"end":return a.stop()}}))},yt=function(t){var e,a,n,r=arguments;return s.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=r.length>1&&void 0!==r[1]?r[1]:0,a={offset:e},i.next=4,s.a.awrap(dt.get("/album/".concat(t.id,"/tracks"),{params:a}));case 4:return(n=i.sent).data.tracks.forEach((function(e){return e.album=t})),i.abrupt("return",n.data);case 7:case"end":return i.stop()}}))},bt=function(t){var e,a,n,r=arguments;return s.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=r.length>1&&void 0!==r[1]?r[1]:0,a={offset:e},i.next=4,s.a.awrap(dt.get("/artist/".concat(t.id,"/details"),{params:a}));case 4:return n=i.sent,i.abrupt("return",n.data);case 6:case"end":return i.stop()}}))},wt=function(t){var e,a,n,r=arguments;return s.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=r.length>1&&void 0!==r[1]?r[1]:0,a={offset:e},i.next=4,s.a.awrap(dt.get("/playlist/".concat(t.id,"/tracks"),{params:a}));case 4:return(n=i.sent).data.tracks=n.data.tracks.map((function(t){return t.track})),i.abrupt("return",n.data);case 7:case"end":return i.stop()}}))},Et=function(t){function e(t){var a;return Object(m.a)(this,e),(a=Object(k.a)(this,Object(h.a)(e).call(this,t)))._poll=a._poll.bind(Object(p.a)(a)),a._pollingInterval=null,a._previousCurrentTrack=null,a}return Object(d.a)(e,t),Object(_.a)(e,[{key:"componentDidMount",value:function(){this._pollingInterval=setInterval(this._poll,2e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this._pollingInterval),this._pollingInterval=null}},{key:"_poll",value:function(){var t,e;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.a.awrap(vt());case 2:t=a.sent,ht.a.isEqual(this._previousCurrentTrack,t)||((e=this.props.onCurrentTrackChange)&&e(t),this._previousCurrentTrack=t);case 4:case"end":return a.stop()}}),null,this)}},{key:"render",value:function(){return null}}]),e}(r.a.Component),Bt=a(11),At=a.n(Bt),St="https://jukebox.gyhost.icu/hls/playlist.m3u8",Tt=function(t){function e(t){var a;return Object(m.a)(this,e),(a=Object(k.a)(this,Object(h.a)(e).call(this,t)))._onMediaAttached=a._onMediaAttached.bind(Object(p.a)(a)),a._onManifestParsed=a._onManifestParsed.bind(Object(p.a)(a)),a._onError=a._onError.bind(Object(p.a)(a)),a._retryLoadResource=ht.a.throttle(a._retryLoadResource.bind(Object(p.a)(a)),2e3),a._audioRef=r.a.createRef(),a._hls=new At.a,a}return Object(d.a)(e,t),Object(_.a)(e,[{key:"componentDidMount",value:function(){this._hls.attachMedia(this._audioRef.current),this._hls.on(At.a.Events.MEDIA_ATTACHED,this._onMediaAttached)}},{key:"componentDidUpdate",value:function(t){var e=t.prevPlay,a=this.props;e!==a&&(a?this._audioRef.current.play():this._audioRef.current.pause())}},{key:"_onMediaAttached",value:function(){this._hls.loadSource(St),this._hls.on(At.a.Events.MANIFEST_PARSED,this._onManifestParsed),this._hls.on(At.a.Events.ERROR,this._onError)}},{key:"_onManifestParsed",value:function(){var t=this.props.onPlayerReady;t&&t()}},{key:"_onError",value:function(t,e){e.fatal&&(console.log("encounter fatal error, try to recover",e),this._retryLoadResource())}},{key:"_retryLoadResource",value:function(){this._hls.loadSource(St)}},{key:"render",value:function(){return r.a.createElement("audio",{ref:this._audioRef})}}]),e}(r.a.PureComponent),Lt=a(12),gt=a.n(Lt),jt=function(t){function e(t){var a;return Object(m.a)(this,e),(a=Object(k.a)(this,Object(h.a)(e).call(this,t)))._EMPTY_SEARCH_LIST_DATA={albums:null,artists:null,playlists:null,tracks:null},a._onPlayButtonClick=a._onPlayButtonClick.bind(Object(p.a)(a)),a._onPlayerReady=a._onPlayerReady.bind(Object(p.a)(a)),a._onPopState=a._onPopState.bind(Object(p.a)(a)),a._pushState=a._pushState.bind(Object(p.a)(a)),a._onCurrentTrackChange=a._onCurrentTrackChange.bind(Object(p.a)(a)),a._onLoginCallback=a._onLoginCallback.bind(Object(p.a)(a)),a._onQueueTrackButtonClick=a._onQueueTrackButtonClick.bind(Object(p.a)(a)),a._onViewAlbumButtonClick=a._onViewAlbumButtonClick.bind(Object(p.a)(a)),a._onViewArtistButtonClick=a._onViewArtistButtonClick.bind(Object(p.a)(a)),a._onViewPlaylistButtonClick=a._onViewPlaylistButtonClick.bind(Object(p.a)(a)),a._onSearchButtonClick=a._onSearchButtonClick.bind(Object(p.a)(a)),a.state={login:{isLogin:!1,token:null},inQueueTracks:[],currentTrack:null,currentSearchListData:a._EMPTY_SEARCH_LIST_DATA,displayPlayButton:!1,play:!1},window.onpopstate=a._onPopState,a}return Object(d.a)(e,t),Object(_.a)(e,[{key:"_onPlayButtonClick",value:function(){this.setState({play:!0,displayPlayButton:!1})}},{key:"_onPlayerReady",value:function(){this.setState({displayPlayButton:!0})}},{key:"_onPopState",value:function(t){this.setState({currentSearchListData:t.state})}},{key:"_pushState",value:function(){var t=this.state.currentSearchListData;window.history.pushState(t,null,"/")}},{key:"_onCurrentTrackChange",value:function(t){this.setState({currentTrack:t})}},{key:"_onLoginCallback",value:function(t){var e=this;this.setState({login:{isLogin:!0,token:t}},(function(){!function(t){dt.defaults.headers.common.Authorization="Bearer ".concat(t)}(t),window.history.replaceState(e._EMPTY_SEARCH_LIST_DATA,null,"/")}))}},{key:"_onQueueTrackButtonClick",value:function(t){return s.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.awrap(Ct(t));case 2:this.setState((function(e){return{inQueueTracks:[].concat(Object(u.a)(e.inQueueTracks),[t])}}));case 3:case"end":return e.stop()}}),null,this)}},{key:"_onViewAlbumButtonClick",value:function(t){var e,a;return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.a.awrap(yt(t));case 2:e=n.sent,a=e.tracks,this.setState({currentSearchListData:Object(o.a)({},this._EMPTY_SEARCH_LIST_DATA,{tracks:a})},this._pushState);case 5:case"end":return n.stop()}}),null,this)}},{key:"_onViewArtistButtonClick",value:function(t){var e,a,n;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,s.a.awrap(bt(t));case 2:e=r.sent,a=e.tracks,n=e.albums,this.setState({currentSearchListData:Object(o.a)({},this._EMPTY_SEARCH_LIST_DATA,{tracks:a,albums:n})},this._pushState);case 6:case"end":return r.stop()}}),null,this)}},{key:"_onViewPlaylistButtonClick",value:function(t){var e,a;return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s.a.awrap(wt(t));case 2:e=n.sent,a=e.tracks,this.setState({currentSearchListData:Object(o.a)({},this._EMPTY_SEARCH_LIST_DATA,{tracks:a})},this._pushState);case 5:case"end":return n.stop()}}),null,this)}},{key:"_onSearchButtonClick",value:function(t){var e,a,n,r,i;return s.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,s.a.awrap(ft(t));case 2:e=c.sent,a=e.albums,n=e.artists,r=e.tracks,i=e.playlists,this.setState({currentSearchListData:Object(o.a)({},this._EMPTY_SEARCH_LIST_DATA,{albums:a,artists:n,playlists:i,tracks:r})},this._pushState);case 8:case"end":return c.stop()}}),null,this)}},{key:"render",value:function(){if(!this.state.login.isLogin)return r.a.createElement(v,{onLoginCallback:this._onLoginCallback});var t=this.state,e=t.inQueueTracks,a=t.currentTrack,n=t.currentSearchListData,i=t.displayPlayButton,c=t.play;return r.a.createElement("div",{className:gt.a.container},r.a.createElement("div",{className:gt.a.searchBarContainer},r.a.createElement(B,{onSearchButtonClick:this._onSearchButtonClick})),r.a.createElement("div",{className:gt.a.searchListContainer},r.a.createElement(g,Object.assign({},n,{inQueueTracks:e,albumComponent:X,artistComponent:et,playlistComponent:ot,trackComponent:_t,onQueueTrackButtonClick:this._onQueueTrackButtonClick,onViewAlbumButtonClick:this._onViewAlbumButtonClick,onViewArtistButtonClick:this._onViewArtistButtonClick,onViewPlaylistButtonClick:this._onViewPlaylistButtonClick}))),r.a.createElement("div",{className:gt.a.footerBarContainer},r.a.createElement(Q,{currentTrack:a,displayPlayButton:i,onPlayButtonClick:this._onPlayButtonClick})),r.a.createElement(Et,{onCurrentTrackChange:this._onCurrentTrackChange}),r.a.createElement(Tt,{onPlayerReady:this._onPlayerReady,play:c}))}}]),e}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(jt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[46,1,2]]]);
//# sourceMappingURL=main.e0a80b88.chunk.js.map